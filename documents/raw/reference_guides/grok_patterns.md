 



Grok Patterns Supported by RDA Grok Bots
========================================

Following Grok Pattern extraction bots support the pre-defined patterns listed in this page:

*   [@dm:grok](/Bots/cfxdm/#bot-dmgrok)
    
*   [@dm:grok-multi-proc](/Bots/cfxdm/#bot-dmgrok-multi-proc)
    

Example usage:

|     |     |
| --- | --- |
| [1](#__codelineno-0-1)<br>[2](#__codelineno-0-2)<br>[3](#__codelineno-0-3)<br>[4](#__codelineno-0-4)<br>[5](#__codelineno-0-5)<br>[6](#__codelineno-0-6) | `@dm:empty     --> @dm:addrow             description = "Server ip is 10.23.1.245 and port is 2345"     --> @dm:grok             column = "description" &             pattern = "Server ip is %{IP:server_ip} and port is %{INT:server_port}"` |

Playground

[Try this in RDA Playground](https://cfxplayground.cloudfabrix.io/rdac/playground/home?snippet=grok_example)

Grok Patterns: Commonly Used

```[](#__codelineno-1-1) USERNAME [a-zA-Z0-9._-]+ [](#__codelineno-1-2) USER %{USERNAME} [](#__codelineno-1-3) EMAILLOCALPART [a-zA-Z][a-zA-Z0-9_.+-=:]+ [](#__codelineno-1-4) EMAILADDRESS %{EMAILLOCALPART}@%{HOSTNAME} [](#__codelineno-1-5) HTTPDUSER %{EMAILADDRESS}|%{USER} [](#__codelineno-1-6) INT (?:[+-]?(?:[0-9]+)) [](#__codelineno-1-7) BASE10NUM (?<![0-9.+-](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/?%3E[+-]?(?:(?:[0-9]+(?:\.[0-9]+) NUMBER (?:%{BASE10NUM}) [](#__codelineno-1-9) BASE16NUM (?<![0-9A-Fa-f](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/?:[+-]?(?:0x) BASE16FLOAT \b(?<![0-9A-Fa-f.](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/?:[+-]?(?:0x) [](#__codelineno-1-12) POSINT \b(?:[1-9][0-9]*)\b [](#__codelineno-1-13) NONNEGINT \b(?:[0-9]+)\b [](#__codelineno-1-14) WORD \b\w+\b [](#__codelineno-1-15) NOTSPACE \S+ [](#__codelineno-1-16) SPACE \s* [](#__codelineno-1-17) DATA .*? [](#__codelineno-1-18) GREEDYDATA .* [](#__codelineno-1-19) QUOTEDSTRING (?>(?<!\\)(?>"(?>\\.|[^\\"]+)+"|""|(?>'(?>\\.|[^\\']+)+')|''|(?>`(?>\\.|[^\\`]+)+`)|``)) [](#__codelineno-1-20) UUID [A-Fa-f0-9]{8}-(?:[A-Fa-f0-9]{4}-){3}[A-Fa-f0-9]{12} [](#__codelineno-1-21) [](#__codelineno-1-22) # Networking [](#__codelineno-1-23) MAC (?:%{CISCOMAC}|%{WINDOWSMAC}|%{COMMONMAC}) [](#__codelineno-1-24) CISCOMAC (?:(?:[A-Fa-f0-9]{4}\.){2}[A-Fa-f0-9]{4}) [](#__codelineno-1-25) WINDOWSMAC (?:(?:[A-Fa-f0-9]{2}-){5}[A-Fa-f0-9]{2}) [](#__codelineno-1-26) COMMONMAC (?:(?:[A-Fa-f0-9]{2}:){5}[A-Fa-f0-9]{2}) [](#__codelineno-1-27) IPV6 ((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)? [](#__codelineno-1-28) IPV4 (?<![0-9](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/#__codelineno-1-29) IP (?:%{IPV6}|%{IPV4}) [](#__codelineno-1-30) HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b) [](#__codelineno-1-31) IPORHOST (?:%{IP}|%{HOSTNAME}) [](#__codelineno-1-32) HOSTPORT %{IPORHOST}:%{POSINT} [](#__codelineno-1-33) [](#__codelineno-1-34) # paths [](#__codelineno-1-35) PATH (?:%{UNIXPATH}|%{WINPATH}) [](#__codelineno-1-36) UNIXPATH (/([\w_%!$@:.,~-]+|\\.)*)+ [](#__codelineno-1-37) TTY (?:/dev/(pts|tty([pq])?)(\w+)?/?(?:[0-9]+)) [](#__codelineno-1-38) WINPATH (?>[A-Za-z]+:|\\)(?:\\[^\\?*]*)+ [](#__codelineno-1-39) URIPROTO [A-Za-z]+(\+[A-Za-z+]+)? [](#__codelineno-1-40) URIHOST %{IPORHOST}(?::%{POSINT:port})? [](#__codelineno-1-41) # uripath comes loosely from RFC1738, but mostly from what Firefox [](#__codelineno-1-42) # doesn't turn into %XX [](#__codelineno-1-43) URIPATH (?:/[A-Za-z0-9$.+!*'(){},~:;=@#%_\-]*)+ [](#__codelineno-1-44) #URIPARAM \?(?:[A-Za-z0-9]+(?:=(?:[^&]*))?(?:&(?:[A-Za-z0-9]+(?:=(?:[^&]*))?)?)*)? [](#__codelineno-1-45) URIPARAM \?[A-Za-z0-9$.+!*'|(){},~@#%&/=:;_?\-\[\]<>]* [](#__codelineno-1-46) URIPATHPARAM %{URIPATH}(?:%{URIPARAM})? [](#__codelineno-1-47) URI %{URIPROTO}://(?:%{USER}(?::[^@]*)?@)?(?:%{URIHOST})?(?:%{URIPATHPARAM})? [](#__codelineno-1-48) [](#__codelineno-1-49) # Months: January, Feb, 3, 03, 12, December [](#__codelineno-1-50) MONTH \b(?:Jan(?:uary|uar)?|Feb(?:ruary|ruar)?|M(?:a|Ã¤)?r(?:ch|z)?|Apr(?:il)?|Ma(?:y|i)?|Jun(?:e|i)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|O(?:c|k)?t(?:ober)?|Nov(?:ember)?|De(?:c|z)(?:ember)?)\b [](#__codelineno-1-51) MONTHNUM (?:0?[1-9]|1[0-2]) [](#__codelineno-1-52) MONTHNUM2 (?:0[1-9]|1[0-2]) [](#__codelineno-1-53) MONTHDAY (?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9]) [](#__codelineno-1-54) [](#__codelineno-1-55) # Days: Monday, Tue, Thu, etc... [](#__codelineno-1-56) DAY (?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?) [](#__codelineno-1-57) [](#__codelineno-1-58) # Years? [](#__codelineno-1-59) YEAR (?>\d\d){1,2} [](#__codelineno-1-60) HOUR (?:2[0123]|[01]?[0-9]) [](#__codelineno-1-61) MINUTE (?:[0-5][0-9]) [](#__codelineno-1-62) # '60' is a leap second in most time standards and thus is valid. [](#__codelineno-1-63) SECOND (?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?) [](#__codelineno-1-64) TIME (?!<[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/#__codelineno-1-65) # datestamp is YYYY/MM/DD-HH:MM:SS.UUUU (or something like it) [](#__codelineno-1-66) DATE_US %{MONTHNUM}[/-]%{MONTHDAY}[/-]%{YEAR} [](#__codelineno-1-67) DATE_EU %{MONTHDAY}[./-]%{MONTHNUM}[./-]%{YEAR} [](#__codelineno-1-68) ISO8601_TIMEZONE (?:Z|[+-]%{HOUR}(?::?%{MINUTE})) [](#__codelineno-1-69) ISO8601_SECOND (?:%{SECOND}|60) [](#__codelineno-1-70) TIMESTAMP_ISO8601 %{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})?%{ISO8601_TIMEZONE}? [](#__codelineno-1-71) DATE %{DATE_US}|%{DATE_EU} [](#__codelineno-1-72) DATESTAMP %{DATE}[- ]%{TIME} [](#__codelineno-1-73) TZ (?:[PMCE][SD]T|UTC) [](#__codelineno-1-74) DATESTAMP_RFC822 %{DAY} %{MONTH} %{MONTHDAY} %{YEAR} %{TIME} %{TZ} [](#__codelineno-1-75) DATESTAMP_RFC2822 %{DAY}, %{MONTHDAY} %{MONTH} %{YEAR} %{TIME} %{ISO8601_TIMEZONE} [](#__codelineno-1-76) DATESTAMP_OTHER %{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{TZ} %{YEAR} [](#__codelineno-1-77) DATESTAMP_EVENTLOG %{YEAR}%{MONTHNUM2}%{MONTHDAY}%{HOUR}%{MINUTE}%{SECOND} [](#__codelineno-1-78) HTTPDERROR_DATE %{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{YEAR} [](#__codelineno-1-79) [](#__codelineno-1-80) # Syslog Dates: Month Day HH:MM:SS [](#__codelineno-1-81) SYSLOGTIMESTAMP %{MONTH} +%{MONTHDAY} %{TIME} [](#__codelineno-1-82) PROG [\x21-\x5a\x5c\x5e-\x7e]+ [](#__codelineno-1-83) SYSLOGPROG %{PROG:program}(?:\[%{POSINT:pid}\])? [](#__codelineno-1-84) SYSLOGHOST %{IPORHOST} [](#__codelineno-1-85) SYSLOGFACILITY <%{NONNEGINT:facility}.%{NONNEGINT:priority}> [](#__codelineno-1-86) HTTPDATE %{MONTHDAY}/%{MONTH}/%{YEAR}:%{TIME} %{INT} [](#__codelineno-1-87) [](#__codelineno-1-88) # Shortcuts [](#__codelineno-1-89) QS %{QUOTEDSTRING} [](#__codelineno-1-90) [](#__codelineno-1-91) # Log formats [](#__codelineno-1-92) SYSLOGBASE %{SYSLOGTIMESTAMP:timestamp} (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:logsource} %{SYSLOGPROG}: [](#__codelineno-1-93) COMMONAPACHELOG %{IPORHOST:clientip} %{HTTPDUSER:ident} %{USER:auth} \[%{HTTPDATE:timestamp}\] "(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})" %{NUMBER:response} (?:%{NUMBER:bytes}|-) [](#__codelineno-1-94) COMBINEDAPACHELOG %{COMMONAPACHELOG} %{QS:referrer} %{QS:agent} [](#__codelineno-1-95) HTTPD20_ERRORLOG \[%{HTTPDERROR_DATE:timestamp}\] \[%{LOGLEVEL:loglevel}\] (?:\[client %{IPORHOST:clientip}\] ){0,1}%{GREEDYDATA:errormsg} [](#__codelineno-1-96) HTTPD24_ERRORLOG \[%{HTTPDERROR_DATE:timestamp}\] \[%{WORD:module}:%{LOGLEVEL:loglevel}\] \[pid %{POSINT:pid}:tid %{NUMBER:tid}\]( \(%{POSINT:proxy_errorcode}\)%{DATA:proxy_errormessage}:)?( \[client %{IPORHOST:client}:%{POSINT:clientport}\])? %{DATA:errorcode}: %{GREEDYDATA:message} [](#__codelineno-1-97) HTTPD_ERRORLOG %{HTTPD20_ERRORLOG}|%{HTTPD24_ERRORLOG} [](#__codelineno-1-98) [](#__codelineno-1-99) [](#__codelineno-1-100) # Log Levels [](#__codelineno-1-101) LOGLEVEL ([Aa]lert|ALERT|[Tt]race|TRACE|[Dd]ebug|DEBUG|[Nn]otice|NOTICE|[Ii]nfo|INFO|[Ww]arn?(?:ing)?|WARN?(?:ING)?|[Ee]rr?(?:or)?|ERR?(?:OR)?|[Cc]rit?(?:ical)?|CRIT?(?:ICAL)?|[Ff]atal|FATAL|[Ss]evere|SEVERE|EMERG(?:ENCY)?|[Ee]merg(?:ency)?)```

  

Grok Patterns: Firewalls

`[](#__codelineno-2-1) # NetScreen firewall logs [](#__codelineno-2-2) NETSCREENSESSIONLOG %{SYSLOGTIMESTAMP:date} %{IPORHOST:device} %{IPORHOST}: NetScreen device_id=%{WORD:device_id}%{DATA}: start_time=%{QUOTEDSTRING:start_time} duration=%{INT:duration} policy_id=%{INT:policy_id} service=%{DATA:service} proto=%{INT:proto} src zone=%{WORD:src_zone} dst zone=%{WORD:dst_zone} action=%{WORD:action} sent=%{INT:sent} rcvd=%{INT:rcvd} src=%{IPORHOST:src_ip} dst=%{IPORHOST:dst_ip} src_port=%{INT:src_port} dst_port=%{INT:dst_port} src-xlated ip=%{IPORHOST:src_xlated_ip} port=%{INT:src_xlated_port} dst-xlated ip=%{IPORHOST:dst_xlated_ip} port=%{INT:dst_xlated_port} session_id=%{INT:session_id} reason=%{GREEDYDATA:reason} [](#__codelineno-2-3) [](#__codelineno-2-4) #== Cisco ASA == [](#__codelineno-2-5) CISCO_TAGGED_SYSLOG ^<%{POSINT:syslog_pri}>%{CISCOTIMESTAMP:timestamp}( %{SYSLOGHOST:sysloghost})? ?: %%{CISCOTAG:ciscotag}: [](#__codelineno-2-6) CISCOTIMESTAMP %{MONTH} +%{MONTHDAY}(?: %{YEAR})? %{TIME} [](#__codelineno-2-7) CISCOTAG [A-Z0-9]+-%{INT}-(?:[A-Z0-9_]+) [](#__codelineno-2-8) # Common Particles [](#__codelineno-2-9) CISCO_ACTION Built|Teardown|Deny|Denied|denied|requested|permitted|denied by ACL|discarded|est-allowed|Dropping|created|deleted [](#__codelineno-2-10) CISCO_REASON Duplicate TCP SYN|Failed to locate egress interface|Invalid transport field|No matching connection|DNS Response|DNS Query|(?:%{WORD}\s*)* [](#__codelineno-2-11) CISCO_DIRECTION Inbound|inbound|Outbound|outbound [](#__codelineno-2-12) CISCO_INTERVAL first hit|%{INT}-second interval [](#__codelineno-2-13) CISCO_XLATE_TYPE static|dynamic [](#__codelineno-2-14) # ASA-1-104001 [](#__codelineno-2-15) CISCOFW104001 \((?:Primary|Secondary)\) Switching to ACTIVE - %{GREEDYDATA:switch_reason} [](#__codelineno-2-16) # ASA-1-104002 [](#__codelineno-2-17) CISCOFW104002 \((?:Primary|Secondary)\) Switching to STANDBY - %{GREEDYDATA:switch_reason} [](#__codelineno-2-18) # ASA-1-104003 [](#__codelineno-2-19) CISCOFW104003 \((?:Primary|Secondary)\) Switching to FAILED\. [](#__codelineno-2-20) # ASA-1-104004 [](#__codelineno-2-21) CISCOFW104004 \((?:Primary|Secondary)\) Switching to OK\. [](#__codelineno-2-22) # ASA-1-105003 [](#__codelineno-2-23) CISCOFW105003 \((?:Primary|Secondary)\) Monitoring on [Ii]nterface %{GREEDYDATA:interface_name} waiting [](#__codelineno-2-24) # ASA-1-105004 [](#__codelineno-2-25) CISCOFW105004 \((?:Primary|Secondary)\) Monitoring on [Ii]nterface %{GREEDYDATA:interface_name} normal [](#__codelineno-2-26) # ASA-1-105005 [](#__codelineno-2-27) CISCOFW105005 \((?:Primary|Secondary)\) Lost Failover communications with mate on [Ii]nterface %{GREEDYDATA:interface_name} [](#__codelineno-2-28) # ASA-1-105008 [](#__codelineno-2-29) CISCOFW105008 \((?:Primary|Secondary)\) Testing [Ii]nterface %{GREEDYDATA:interface_name} [](#__codelineno-2-30) # ASA-1-105009 [](#__codelineno-2-31) CISCOFW105009 \((?:Primary|Secondary)\) Testing on [Ii]nterface %{GREEDYDATA:interface_name} (?:Passed|Failed) [](#__codelineno-2-32) # ASA-2-106001 [](#__codelineno-2-33) CISCOFW106001 %{CISCO_DIRECTION:direction} %{WORD:protocol} connection %{CISCO_ACTION:action} from %{IP:src_ip}/%{INT:src_port} to %{IP:dst_ip}/%{INT:dst_port} flags %{GREEDYDATA:tcp_flags} on interface %{GREEDYDATA:interface} [](#__codelineno-2-34) # ASA-2-106006, ASA-2-106007, ASA-2-106010 [](#__codelineno-2-35) CISCOFW106006_106007_106010 %{CISCO_ACTION:action} %{CISCO_DIRECTION:direction} %{WORD:protocol} (?:from|src) %{IP:src_ip}/%{INT:src_port}(\(%{DATA:src_fwuser}\))? (?:to|dst) %{IP:dst_ip}/%{INT:dst_port}(\(%{DATA:dst_fwuser}\))? (?:on interface %{DATA:interface}|due to %{CISCO_REASON:reason}) [](#__codelineno-2-36) # ASA-3-106014 [](#__codelineno-2-37) CISCOFW106014 %{CISCO_ACTION:action} %{CISCO_DIRECTION:direction} %{WORD:protocol} src %{DATA:src_interface}:%{IP:src_ip}(\(%{DATA:src_fwuser}\))? dst %{DATA:dst_interface}:%{IP:dst_ip}(\(%{DATA:dst_fwuser}\))? \(type %{INT:icmp_type}, code %{INT:icmp_code}\) [](#__codelineno-2-38) # ASA-6-106015 [](#__codelineno-2-39) CISCOFW106015 %{CISCO_ACTION:action} %{WORD:protocol} \(%{DATA:policy_id}\) from %{IP:src_ip}/%{INT:src_port} to %{IP:dst_ip}/%{INT:dst_port} flags %{DATA:tcp_flags}  on interface %{GREEDYDATA:interface} [](#__codelineno-2-40) # ASA-1-106021 [](#__codelineno-2-41) CISCOFW106021 %{CISCO_ACTION:action} %{WORD:protocol} reverse path check from %{IP:src_ip} to %{IP:dst_ip} on interface %{GREEDYDATA:interface} [](#__codelineno-2-42) # ASA-4-106023 [](#__codelineno-2-43) CISCOFW106023 %{CISCO_ACTION:action}( protocol)? %{WORD:protocol} src %{DATA:src_interface}:%{DATA:src_ip}(/%{INT:src_port})?(\(%{DATA:src_fwuser}\))? dst %{DATA:dst_interface}:%{DATA:dst_ip}(/%{INT:dst_port})?(\(%{DATA:dst_fwuser}\))?( \(type %{INT:icmp_type}, code %{INT:icmp_code}\))? by access-group "?%{DATA:policy_id}"? \[%{DATA:hashcode1}, %{DATA:hashcode2}\] [](#__codelineno-2-44) # ASA-4-106100, ASA-4-106102, ASA-4-106103 [](#__codelineno-2-45) CISCOFW106100_2_3 access-list %{NOTSPACE:policy_id} %{CISCO_ACTION:action} %{WORD:protocol} for user '%{DATA:src_fwuser}' %{DATA:src_interface}/%{IP:src_ip}\(%{INT:src_port}\) -> %{DATA:dst_interface}/%{IP:dst_ip}\(%{INT:dst_port}\) hit-cnt %{INT:hit_count} %{CISCO_INTERVAL:interval} \[%{DATA:hashcode1}, %{DATA:hashcode2}\] [](#__codelineno-2-46) # ASA-5-106100 [](#__codelineno-2-47) CISCOFW106100 access-list %{NOTSPACE:policy_id} %{CISCO_ACTION:action} %{WORD:protocol} %{DATA:src_interface}/%{IP:src_ip}\(%{INT:src_port}\)(\(%{DATA:src_fwuser}\))? -> %{DATA:dst_interface}/%{IP:dst_ip}\(%{INT:dst_port}\)(\(%{DATA:src_fwuser}\))? hit-cnt %{INT:hit_count} %{CISCO_INTERVAL:interval} \[%{DATA:hashcode1}, %{DATA:hashcode2}\] [](#__codelineno-2-48) # ASA-6-110002 [](#__codelineno-2-49) CISCOFW110002 %{CISCO_REASON:reason} for %{WORD:protocol} from %{DATA:src_interface}:%{IP:src_ip}/%{INT:src_port} to %{IP:dst_ip}/%{INT:dst_port} [](#__codelineno-2-50) # ASA-6-302010 [](#__codelineno-2-51) CISCOFW302010 %{INT:connection_count} in use, %{INT:connection_count_max} most used [](#__codelineno-2-52) # ASA-6-302013, ASA-6-302014, ASA-6-302015, ASA-6-302016 [](#__codelineno-2-53) CISCOFW302013_302014_302015_302016 %{CISCO_ACTION:action}(?: %{CISCO_DIRECTION:direction})? %{WORD:protocol} connection %{INT:connection_id} for %{DATA:src_interface}:%{IP:src_ip}/%{INT:src_port}( \(%{IP:src_mapped_ip}/%{INT:src_mapped_port}\))?(\(%{DATA:src_fwuser}\))? to %{DATA:dst_interface}:%{IP:dst_ip}/%{INT:dst_port}( \(%{IP:dst_mapped_ip}/%{INT:dst_mapped_port}\))?(\(%{DATA:dst_fwuser}\))?( duration %{TIME:duration} bytes %{INT:bytes})?(?: %{CISCO_REASON:reason})?( \(%{DATA:user}\))? [](#__codelineno-2-54) # ASA-6-302020, ASA-6-302021 [](#__codelineno-2-55) CISCOFW302020_302021 %{CISCO_ACTION:action}(?: %{CISCO_DIRECTION:direction})? %{WORD:protocol} connection for faddr %{IP:dst_ip}/%{INT:icmp_seq_num}(?:\(%{DATA:fwuser}\))? gaddr %{IP:src_xlated_ip}/%{INT:icmp_code_xlated} laddr %{IP:src_ip}/%{INT:icmp_code}( \(%{DATA:user}\))? [](#__codelineno-2-56) # ASA-6-305011 [](#__codelineno-2-57) CISCOFW305011 %{CISCO_ACTION:action} %{CISCO_XLATE_TYPE:xlate_type} %{WORD:protocol} translation from %{DATA:src_interface}:%{IP:src_ip}(/%{INT:src_port})?(\(%{DATA:src_fwuser}\))? to %{DATA:src_xlated_interface}:%{IP:src_xlated_ip}/%{DATA:src_xlated_port} [](#__codelineno-2-58) # ASA-3-313001, ASA-3-313004, ASA-3-313008 [](#__codelineno-2-59) CISCOFW313001_313004_313008 %{CISCO_ACTION:action} %{WORD:protocol} type=%{INT:icmp_type}, code=%{INT:icmp_code} from %{IP:src_ip} on interface %{DATA:interface}( to %{IP:dst_ip})? [](#__codelineno-2-60) # ASA-4-313005 [](#__codelineno-2-61) CISCOFW313005 %{CISCO_REASON:reason} for %{WORD:protocol} error message: %{WORD:err_protocol} src %{DATA:err_src_interface}:%{IP:err_src_ip}(\(%{DATA:err_src_fwuser}\))? dst %{DATA:err_dst_interface}:%{IP:err_dst_ip}(\(%{DATA:err_dst_fwuser}\))? \(type %{INT:err_icmp_type}, code %{INT:err_icmp_code}\) on %{DATA:interface} interface\.  Original IP payload: %{WORD:protocol} src %{IP:orig_src_ip}/%{INT:orig_src_port}(\(%{DATA:orig_src_fwuser}\))? dst %{IP:orig_dst_ip}/%{INT:orig_dst_port}(\(%{DATA:orig_dst_fwuser}\))? [](#__codelineno-2-62) # ASA-5-321001 [](#__codelineno-2-63) CISCOFW321001 Resource '%{WORD:resource_name}' limit of %{POSINT:resource_limit} reached for system [](#__codelineno-2-64) # ASA-4-402117 [](#__codelineno-2-65) CISCOFW402117 %{WORD:protocol}: Received a non-IPSec packet \(protocol= %{WORD:orig_protocol}\) from %{IP:src_ip} to %{IP:dst_ip} [](#__codelineno-2-66) # ASA-4-402119 [](#__codelineno-2-67) CISCOFW402119 %{WORD:protocol}: Received an %{WORD:orig_protocol} packet \(SPI= %{DATA:spi}, sequence number= %{DATA:seq_num}\) from %{IP:src_ip} \(user= %{DATA:user}\) to %{IP:dst_ip} that failed anti-replay checking [](#__codelineno-2-68) # ASA-4-419001 [](#__codelineno-2-69) CISCOFW419001 %{CISCO_ACTION:action} %{WORD:protocol} packet from %{DATA:src_interface}:%{IP:src_ip}/%{INT:src_port} to %{DATA:dst_interface}:%{IP:dst_ip}/%{INT:dst_port}, reason: %{GREEDYDATA:reason} [](#__codelineno-2-70) # ASA-4-419002 [](#__codelineno-2-71) CISCOFW419002 %{CISCO_REASON:reason} from %{DATA:src_interface}:%{IP:src_ip}/%{INT:src_port} to %{DATA:dst_interface}:%{IP:dst_ip}/%{INT:dst_port} with different initial sequence number [](#__codelineno-2-72) # ASA-4-500004 [](#__codelineno-2-73) CISCOFW500004 %{CISCO_REASON:reason} for protocol=%{WORD:protocol}, from %{IP:src_ip}/%{INT:src_port} to %{IP:dst_ip}/%{INT:dst_port} [](#__codelineno-2-74) # ASA-6-602303, ASA-6-602304 [](#__codelineno-2-75) CISCOFW602303_602304 %{WORD:protocol}: An %{CISCO_DIRECTION:direction} %{GREEDYDATA:tunnel_type} SA \(SPI= %{DATA:spi}\) between %{IP:src_ip} and %{IP:dst_ip} \(user= %{DATA:user}\) has been %{CISCO_ACTION:action} [](#__codelineno-2-76) # ASA-7-710001, ASA-7-710002, ASA-7-710003, ASA-7-710005, ASA-7-710006 [](#__codelineno-2-77) CISCOFW710001_710002_710003_710005_710006 %{WORD:protocol} (?:request|access) %{CISCO_ACTION:action} from %{IP:src_ip}/%{INT:src_port} to %{DATA:dst_interface}:%{IP:dst_ip}/%{INT:dst_port} [](#__codelineno-2-78) # ASA-6-713172 [](#__codelineno-2-79) CISCOFW713172 Group = %{GREEDYDATA:group}, IP = %{IP:src_ip}, Automatic NAT Detection Status:\s+Remote end\s*%{DATA:is_remote_natted}\s*behind a NAT device\s+This\s+end\s*%{DATA:is_local_natted}\s*behind a NAT device [](#__codelineno-2-80) # ASA-4-733100 [](#__codelineno-2-81) CISCOFW733100 \[\s*%{DATA:drop_type}\s*\] drop %{DATA:drop_rate_id} exceeded. Current burst rate is %{INT:drop_rate_current_burst} per second, max configured rate is %{INT:drop_rate_max_burst}; Current average rate is %{INT:drop_rate_current_avg} per second, max configured rate is %{INT:drop_rate_max_avg}; Cumulative total count is %{INT:drop_total_count} [](#__codelineno-2-82) #== End Cisco ASA == [](#__codelineno-2-83) [](#__codelineno-2-84) # Shorewall firewall logs [](#__codelineno-2-85) SHOREWALL (%{SYSLOGTIMESTAMP:timestamp}) (%{WORD:nf_host}) kernel:.*Shorewall:(%{WORD:nf_action1})?:(%{WORD:nf_action2})?.*IN=(%{USERNAME:nf_in_interface})?.*(OUT= *MAC=(%{COMMONMAC:nf_dst_mac}):(%{COMMONMAC:nf_src_mac})?|OUT=%{USERNAME:nf_out_interface}).*SRC=(%{IPV4:nf_src_ip}).*DST=(%{IPV4:nf_dst_ip}).*LEN=(%{WORD:nf_len}).?*TOS=(%{WORD:nf_tos}).?*PREC=(%{WORD:nf_prec}).?*TTL=(%{INT:nf_ttl}).?*ID=(%{INT:nf_id}).?*PROTO=(%{WORD:nf_protocol}).?*SPT=(%{INT:nf_src_port}?.*DPT=%{INT:nf_dst_port}?.*) [](#__codelineno-2-86) #== End Shorewall`

  

Grok Patterns: Linux-Syslog

`[](#__codelineno-3-1) SYSLOG5424PRINTASCII [!-~]+ [](#__codelineno-3-2) [](#__codelineno-3-3) SYSLOGBASE2 (?:%{SYSLOGTIMESTAMP:timestamp}|%{TIMESTAMP_ISO8601:timestamp8601}) (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:logsource}+(?: %{SYSLOGPROG}:|) [](#__codelineno-3-4) SYSLOGPAMSESSION %{SYSLOGBASE} (?=%{GREEDYDATA:message})%{WORD:pam_module}\(%{DATA:pam_caller}\): session %{WORD:pam_session_state} for user %{USERNAME:username}(?: by %{GREEDYDATA:pam_by})? [](#__codelineno-3-5) [](#__codelineno-3-6) CRON_ACTION [A-Z ]+ [](#__codelineno-3-7) CRONLOG %{SYSLOGBASE} \(%{USER:user}\) %{CRON_ACTION:action} \(%{DATA:message}\) [](#__codelineno-3-8) [](#__codelineno-3-9) SYSLOGLINE %{SYSLOGBASE2} %{GREEDYDATA:message} [](#__codelineno-3-10) [](#__codelineno-3-11) # IETF 5424 syslog(8) format (see http://www.rfc-editor.org/info/rfc5424) [](#__codelineno-3-12) SYSLOG5424PRI <%{NONNEGINT:syslog5424_pri}> [](#__codelineno-3-13) SYSLOG5424SD \[%{DATA}\]+ [](#__codelineno-3-14) SYSLOG5424BASE %{SYSLOG5424PRI}%{NONNEGINT:syslog5424_ver} +(?:%{TIMESTAMP_ISO8601:syslog5424_ts}|-) +(?:%{HOSTNAME:syslog5424_host}|-) +(-|%{SYSLOG5424PRINTASCII:syslog5424_app}) +(-|%{SYSLOG5424PRINTASCII:syslog5424_proc}) +(-|%{SYSLOG5424PRINTASCII:syslog5424_msgid}) +(?:%{SYSLOG5424SD:syslog5424_sd}|-|) [](#__codelineno-3-15) [](#__codelineno-3-16) SYSLOG5424LINE %{SYSLOG5424BASE} +%{GREEDYDATA:syslog5424_msg}`

  

Grok Patterns: Haproxy

`[](#__codelineno-4-1) ## These patterns were tested w/ haproxy-1.4.15 [](#__codelineno-4-2) [](#__codelineno-4-3) ## Documentation of the haproxy log formats can be found at the following links: [](#__codelineno-4-4) ## http://code.google.com/p/haproxy-docs/wiki/HTTPLogFormat [](#__codelineno-4-5) ## http://code.google.com/p/haproxy-docs/wiki/TCPLogFormat [](#__codelineno-4-6) [](#__codelineno-4-7) HAPROXYTIME (?!<[0-9])%{HOUR:haproxy_hour}:%{MINUTE:haproxy_minute}(?::%{SECOND:haproxy_second})(?![0-9](https://bot-docs.cloudfabrix.io/reference_guides/grok_patterns/#__codelineno-4-8) HAPROXYDATE %{MONTHDAY:haproxy_monthday}/%{MONTH:haproxy_month}/%{YEAR:haproxy_year}:%{HAPROXYTIME:haproxy_time}.%{INT:haproxy_milliseconds} [](#__codelineno-4-9) [](#__codelineno-4-10) # Override these default patterns to parse out what is captured in your haproxy.cfg [](#__codelineno-4-11) HAPROXYCAPTUREDREQUESTHEADERS %{DATA:captured_request_headers} [](#__codelineno-4-12) HAPROXYCAPTUREDRESPONSEHEADERS %{DATA:captured_response_headers} [](#__codelineno-4-13) [](#__codelineno-4-14) # Example: [](#__codelineno-4-15) #  These haproxy config lines will add data to the logs that are captured [](#__codelineno-4-16) #  by the patterns below. Place them in your custom patterns directory to [](#__codelineno-4-17) #  override the defaults. [](#__codelineno-4-18) # [](#__codelineno-4-19) #  capture request header Host len 40 [](#__codelineno-4-20) #  capture request header X-Forwarded-For len 50 [](#__codelineno-4-21) #  capture request header Accept-Language len 50 [](#__codelineno-4-22) #  capture request header Referer len 200 [](#__codelineno-4-23) #  capture request header User-Agent len 200 [](#__codelineno-4-24) # [](#__codelineno-4-25) #  capture response header Content-Type len 30 [](#__codelineno-4-26) #  capture response header Content-Encoding len 10 [](#__codelineno-4-27) #  capture response header Cache-Control len 200 [](#__codelineno-4-28) #  capture response header Last-Modified len 200 [](#__codelineno-4-29) # [](#__codelineno-4-30) # HAPROXYCAPTUREDREQUESTHEADERS %{DATA:request_header_host}\|%{DATA:request_header_x_forwarded_for}\|%{DATA:request_header_accept_language}\|%{DATA:request_header_referer}\|%{DATA:request_header_user_agent} [](#__codelineno-4-31) # HAPROXYCAPTUREDRESPONSEHEADERS %{DATA:response_header_content_type}\|%{DATA:response_header_content_encoding}\|%{DATA:response_header_cache_control}\|%{DATA:response_header_last_modified} [](#__codelineno-4-32) [](#__codelineno-4-33) # parse a haproxy 'httplog' line [](#__codelineno-4-34) HAPROXYHTTPBASE %{IP:client_ip}:%{INT:client_port} \[%{HAPROXYDATE:accept_date}\] %{NOTSPACE:frontend_name} %{NOTSPACE:backend_name}/%{NOTSPACE:server_name} %{INT:time_request}/%{INT:time_queue}/%{INT:time_backend_connect}/%{INT:time_backend_response}/%{NOTSPACE:time_duration} %{INT:http_status_code} %{NOTSPACE:bytes_read} %{DATA:captured_request_cookie} %{DATA:captured_response_cookie} %{NOTSPACE:termination_state} %{INT:actconn}/%{INT:feconn}/%{INT:beconn}/%{INT:srvconn}/%{NOTSPACE:retries} %{INT:srv_queue}/%{INT:backend_queue} (\{%{HAPROXYCAPTUREDREQUESTHEADERS}\})?( )?(\{%{HAPROXYCAPTUREDRESPONSEHEADERS}\})?( )?"(<BADREQ>|(%{WORD:http_verb} (%{URIPROTO:http_proto}://)?(?:%{USER:http_user}(?::[^@]*)?@)?(?:%{URIHOST:http_host})?(?:%{URIPATHPARAM:http_request})?( HTTP/%{NUMBER:http_version})?))?" [](#__codelineno-4-35) [](#__codelineno-4-36) HAPROXYHTTP (?:%{SYSLOGTIMESTAMP:syslog_timestamp}|%{TIMESTAMP_ISO8601:timestamp8601}) %{IPORHOST:syslog_server} %{SYSLOGPROG}: %{HAPROXYHTTPBASE} [](#__codelineno-4-37) [](#__codelineno-4-38) # parse a haproxy 'tcplog' line [](#__codelineno-4-39) HAPROXYTCP (?:%{SYSLOGTIMESTAMP:syslog_timestamp}|%{TIMESTAMP_ISO8601:timestamp8601}) %{IPORHOST:syslog_server} %{SYSLOGPROG}: %{IP:client_ip}:%{INT:client_port} \[%{HAPROXYDATE:accept_date}\] %{NOTSPACE:frontend_name} %{NOTSPACE:backend_name}/%{NOTSPACE:server_name} %{INT:time_queue}/%{INT:time_backend_connect}/%{NOTSPACE:time_duration} %{NOTSPACE:bytes_read} %{NOTSPACE:termination_state} %{INT:actconn}/%{INT:feconn}/%{INT:beconn}/%{INT:srvconn}/%{NOTSPACE:retries} %{INT:srv_queue}/%{INT:backend_queue}`

  

Grok Patterns: Java

`[](#__codelineno-5-1) JAVACLASS (?:[a-zA-Z$_][a-zA-Z$_0-9]*\.)*[a-zA-Z$_][a-zA-Z$_0-9]* [](#__codelineno-5-2) #Space is an allowed character to match special cases like 'Native Method' or 'Unknown Source' [](#__codelineno-5-3) JAVAFILE (?:[A-Za-z0-9_. -]+) [](#__codelineno-5-4) #Allow special <init> method [](#__codelineno-5-5) JAVAMETHOD (?:(<init>)|[a-zA-Z$_][a-zA-Z$_0-9]*) [](#__codelineno-5-6) #Line number is optional in special cases 'Native method' or 'Unknown source' [](#__codelineno-5-7) JAVASTACKTRACEPART %{SPACE}at %{JAVACLASS:class}\.%{JAVAMETHOD:method}\(%{JAVAFILE:file}(?::%{NUMBER:line})?\) [](#__codelineno-5-8) # Java Logs [](#__codelineno-5-9) JAVATHREAD (?:[A-Z]{2}-Processor[\d]+) [](#__codelineno-5-10) JAVACLASS (?:[a-zA-Z0-9-]+\.)+[A-Za-z0-9$]+ [](#__codelineno-5-11) JAVAFILE (?:[A-Za-z0-9_.-]+) [](#__codelineno-5-12) JAVASTACKTRACEPART at %{JAVACLASS:class}\.%{WORD:method}\(%{JAVAFILE:file}:%{NUMBER:line}\) [](#__codelineno-5-13) JAVALOGMESSAGE (.*) [](#__codelineno-5-14) # MMM dd, yyyy HH:mm:ss eg: Jan 9, 2014 7:13:13 AM [](#__codelineno-5-15) CATALINA_DATESTAMP %{MONTH} %{MONTHDAY}, 20%{YEAR} %{HOUR}:?%{MINUTE}(?::?%{SECOND}) (?:AM|PM) [](#__codelineno-5-16) # yyyy-MM-dd HH:mm:ss,SSS ZZZ eg: 2014-01-09 17:32:25,527 -0800 [](#__codelineno-5-17) TOMCAT_DATESTAMP 20%{YEAR}-%{MONTHNUM}-%{MONTHDAY} %{HOUR}:?%{MINUTE}(?::?%{SECOND}) %{ISO8601_TIMEZONE} [](#__codelineno-5-18) CATALINALOG %{CATALINA_DATESTAMP:timestamp} %{JAVACLASS:class} %{JAVALOGMESSAGE:logmessage} [](#__codelineno-5-19) # 2014-01-09 20:03:28,269 -0800 | ERROR | com.example.service.ExampleService - something compeletely unexpected happened... [](#__codelineno-5-20) TOMCATLOG %{TOMCAT_DATESTAMP:timestamp} \| %{LOGLEVEL:level} \| %{JAVACLASS:class} - %{JAVALOGMESSAGE:logmessage}`

  

Grok Patterns: Junos

`[](#__codelineno-6-1) # JUNOS 11.4 RT_FLOW patterns [](#__codelineno-6-2) RT_FLOW_EVENT (RT_FLOW_SESSION_CREATE|RT_FLOW_SESSION_CLOSE|RT_FLOW_SESSION_DENY) [](#__codelineno-6-3) [](#__codelineno-6-4) RT_FLOW1 %{RT_FLOW_EVENT:event}: %{GREEDYDATA:close-reason}: %{IP:src-ip}/%{INT:src-port}->%{IP:dst-ip}/%{INT:dst-port} %{DATA:service} %{IP:nat-src-ip}/%{INT:nat-src-port}->%{IP:nat-dst-ip}/%{INT:nat-dst-port} %{DATA:src-nat-rule-name} %{DATA:dst-nat-rule-name} %{INT:protocol-id} %{DATA:policy-name} %{DATA:from-zone} %{DATA:to-zone} %{INT:session-id} \d+\(%{DATA:sent}\) \d+\(%{DATA:received}\) %{INT:elapsed-time} .* [](#__codelineno-6-5) [](#__codelineno-6-6) RT_FLOW2 %{RT_FLOW_EVENT:event}: session created %{IP:src-ip}/%{INT:src-port}->%{IP:dst-ip}/%{INT:dst-port} %{DATA:service} %{IP:nat-src-ip}/%{INT:nat-src-port}->%{IP:nat-dst-ip}/%{INT:nat-dst-port} %{DATA:src-nat-rule-name} %{DATA:dst-nat-rule-name} %{INT:protocol-id} %{DATA:policy-name} %{DATA:from-zone} %{DATA:to-zone} %{INT:session-id} .* [](#__codelineno-6-7) [](#__codelineno-6-8) RT_FLOW3 %{RT_FLOW_EVENT:event}: session denied %{IP:src-ip}/%{INT:src-port}->%{IP:dst-ip}/%{INT:dst-port} %{DATA:service} %{INT:protocol-id}\(\d\) %{DATA:policy-name} %{DATA:from-zone} %{DATA:to-zone} .*`

  

Grok Patterns: Mongodb

`[](#__codelineno-7-1) MONGO_LOG %{SYSLOGTIMESTAMP:timestamp} \[%{WORD:component}\] %{GREEDYDATA:message} [](#__codelineno-7-2) MONGO_QUERY \{ (?<={ ).*(?= } ntoreturn:) \} [](#__codelineno-7-3) MONGO_SLOWQUERY %{WORD} %{MONGO_WORDDASH:database}\.%{MONGO_WORDDASH:collection} %{WORD}: %{MONGO_QUERY:query} %{WORD}:%{NONNEGINT:ntoreturn} %{WORD}:%{NONNEGINT:ntoskip} %{WORD}:%{NONNEGINT:nscanned}.*nreturned:%{NONNEGINT:nreturned}..+ (?<duration>[0-9]+)ms [](#__codelineno-7-4) MONGO_WORDDASH \b[\w-]+\b [](#__codelineno-7-5) MONGO3_SEVERITY \w [](#__codelineno-7-6) MONGO3_COMPONENT %{WORD}|- [](#__codelineno-7-7) MONGO3_LOG %{TIMESTAMP_ISO8601:timestamp} %{MONGO3_SEVERITY:severity} %{MONGO3_COMPONENT:component}%{SPACE}(?:\[%{DATA:context}\])? %{GREEDYDATA:message}`

  

Grok Patterns: Redis

`[](#__codelineno-8-1) REDISTIMESTAMP %{MONTHDAY} %{MONTH} %{TIME} [](#__codelineno-8-2) REDISLOG \[%{POSINT:pid}\] %{REDISTIMESTAMP:timestamp} \*` 

  

Grok Patterns: Ruby

`[](#__codelineno-9-1) RUBY_LOGLEVEL (?:DEBUG|FATAL|ERROR|WARN|INFO) [](#__codelineno-9-2) RUBY_LOGGER [DFEWI], \[%{TIMESTAMP_ISO8601:timestamp} #%{POSINT:pid}\] *%{RUBY_LOGLEVEL:loglevel} -- +%{DATA:progname}: %{GREEDYDATA:message}`

  

Grok Patterns: Aws

`[](#__codelineno-10-1) S3_REQUEST_LINE (?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest}) [](#__codelineno-10-2) [](#__codelineno-10-3) S3_ACCESS_LOG %{WORD:owner} %{NOTSPACE:bucket} \[%{HTTPDATE:timestamp}\] %{IP:clientip} %{NOTSPACE:requester} %{NOTSPACE:request_id} %{NOTSPACE:operation} %{NOTSPACE:key} (?:"%{S3_REQUEST_LINE}"|-) (?:%{INT:response:int}|-) (?:-|%{NOTSPACE:error_code}) (?:%{INT:bytes:int}|-) (?:%{INT:object_size:int}|-) (?:%{INT:request_time_ms:int}|-) (?:%{INT:turnaround_time_ms:int}|-) (?:%{QS:referrer}|-) (?:"?%{QS:agent}"?|-) (?:-|%{NOTSPACE:version_id}) [](#__codelineno-10-4) [](#__codelineno-10-5) ELB_URIPATHPARAM %{URIPATH:path}(?:%{URIPARAM:params})? [](#__codelineno-10-6) [](#__codelineno-10-7) ELB_URI %{URIPROTO:proto}://(?:%{USER}(?::[^@]*)?@)?(?:%{URIHOST:urihost})?(?:%{ELB_URIPATHPARAM})? [](#__codelineno-10-8) [](#__codelineno-10-9) ELB_REQUEST_LINE (?:%{WORD:verb} %{ELB_URI:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest}) [](#__codelineno-10-10) [](#__codelineno-10-11) ELB_ACCESS_LOG %{TIMESTAMP_ISO8601:timestamp} %{NOTSPACE:elb} %{IP:clientip}:%{INT:clientport:int} (?:(%{IP:backendip}:?:%{INT:backendport:int})|-) %{NUMBER:request_processing_time:float} %{NUMBER:backend_processing_time:float} %{NUMBER:response_processing_time:float} %{INT:response:int} %{INT:backend_response:int} %{INT:received_bytes:int} %{INT:bytes:int} "%{ELB_REQUEST_LINE}"`

  

Grok Patterns: Rails

`[](#__codelineno-11-1) RUUID \h{32} [](#__codelineno-11-2) # rails controller with action [](#__codelineno-11-3) RCONTROLLER (?<controller>[^#]+)#(?<action>\w+) [](#__codelineno-11-4) [](#__codelineno-11-5) # this will often be the only line: [](#__codelineno-11-6) RAILS3HEAD (?m)Started %{WORD:verb} "%{URIPATHPARAM:request}" for %{IPORHOST:clientip} at (?<timestamp>%{YEAR}-%{MONTHNUM}-%{MONTHDAY} %{HOUR}:%{MINUTE}:%{SECOND} %{ISO8601_TIMEZONE}) [](#__codelineno-11-7) # for some a strange reason, params are stripped of {} - not sure that's a good idea. [](#__codelineno-11-8) RPROCESSING \W*Processing by %{RCONTROLLER} as (?<format>\S+)(?:\W*Parameters: {%{DATA:params}}\W*)? [](#__codelineno-11-9) RAILS3FOOT Completed %{NUMBER:response}%{DATA} in %{NUMBER:totalms}ms %{RAILS3PROFILE}%{GREEDYDATA} [](#__codelineno-11-10) RAILS3PROFILE (?:\(Views: %{NUMBER:viewms}ms \| ActiveRecord: %{NUMBER:activerecordms}ms|\(ActiveRecord: %{NUMBER:activerecordms}ms)? [](#__codelineno-11-11) [](#__codelineno-11-12) # putting it all together [](#__codelineno-11-13) RAILS3 %{RAILS3HEAD}(?:%{RPROCESSING})?(?<context>(?:%{DATA}\n)*)(?:%{RAILS3FOOT})?`

  

Grok Patterns: Nagios

`[](#__codelineno-12-1) ################################################################################## [](#__codelineno-12-2) ################################################################################## [](#__codelineno-12-3) # Chop Nagios log files to smithereens! [](#__codelineno-12-4) # [](#__codelineno-12-5) # A set of GROK filters to process logfiles generated by Nagios. [](#__codelineno-12-6) # While it does not, this set intends to cover all possible Nagios logs. [](#__codelineno-12-7) # [](#__codelineno-12-8) # Some more work needs to be done to cover all External Commands: [](#__codelineno-12-9) #   http://old.nagios.org/developerinfo/externalcommands/commandlist.php [](#__codelineno-12-10) # [](#__codelineno-12-11) # If you need some support on these rules please contact: [](#__codelineno-12-12) #   Jelle Smet http://smetj.net [](#__codelineno-12-13) # [](#__codelineno-12-14) ################################################################################# [](#__codelineno-12-15) ################################################################################# [](#__codelineno-12-16) [](#__codelineno-12-17) NAGIOSTIME \[%{NUMBER:nagios_epoch}\] [](#__codelineno-12-18) [](#__codelineno-12-19) ############################################### [](#__codelineno-12-20) ######## Begin nagios log types [](#__codelineno-12-21) ############################################### [](#__codelineno-12-22) NAGIOS_TYPE_CURRENT_SERVICE_STATE CURRENT SERVICE STATE [](#__codelineno-12-23) NAGIOS_TYPE_CURRENT_HOST_STATE CURRENT HOST STATE [](#__codelineno-12-24) [](#__codelineno-12-25) NAGIOS_TYPE_SERVICE_NOTIFICATION SERVICE NOTIFICATION [](#__codelineno-12-26) NAGIOS_TYPE_HOST_NOTIFICATION HOST NOTIFICATION [](#__codelineno-12-27) [](#__codelineno-12-28) NAGIOS_TYPE_SERVICE_ALERT SERVICE ALERT [](#__codelineno-12-29) NAGIOS_TYPE_HOST_ALERT HOST ALERT [](#__codelineno-12-30) [](#__codelineno-12-31) NAGIOS_TYPE_SERVICE_FLAPPING_ALERT SERVICE FLAPPING ALERT [](#__codelineno-12-32) NAGIOS_TYPE_HOST_FLAPPING_ALERT HOST FLAPPING ALERT [](#__codelineno-12-33) [](#__codelineno-12-34) NAGIOS_TYPE_SERVICE_DOWNTIME_ALERT SERVICE DOWNTIME ALERT [](#__codelineno-12-35) NAGIOS_TYPE_HOST_DOWNTIME_ALERT HOST DOWNTIME ALERT [](#__codelineno-12-36) [](#__codelineno-12-37) NAGIOS_TYPE_PASSIVE_SERVICE_CHECK PASSIVE SERVICE CHECK [](#__codelineno-12-38) NAGIOS_TYPE_PASSIVE_HOST_CHECK PASSIVE HOST CHECK [](#__codelineno-12-39) [](#__codelineno-12-40) NAGIOS_TYPE_SERVICE_EVENT_HANDLER SERVICE EVENT HANDLER [](#__codelineno-12-41) NAGIOS_TYPE_HOST_EVENT_HANDLER HOST EVENT HANDLER [](#__codelineno-12-42) [](#__codelineno-12-43) NAGIOS_TYPE_EXTERNAL_COMMAND EXTERNAL COMMAND [](#__codelineno-12-44) NAGIOS_TYPE_TIMEPERIOD_TRANSITION TIMEPERIOD TRANSITION [](#__codelineno-12-45) ############################################### [](#__codelineno-12-46) ######## End nagios log types [](#__codelineno-12-47) ############################################### [](#__codelineno-12-48) [](#__codelineno-12-49) ############################################### [](#__codelineno-12-50) ######## Begin external check types [](#__codelineno-12-51) ############################################### [](#__codelineno-12-52) NAGIOS_EC_DISABLE_SVC_CHECK DISABLE_SVC_CHECK [](#__codelineno-12-53) NAGIOS_EC_ENABLE_SVC_CHECK ENABLE_SVC_CHECK [](#__codelineno-12-54) NAGIOS_EC_DISABLE_HOST_CHECK DISABLE_HOST_CHECK [](#__codelineno-12-55) NAGIOS_EC_ENABLE_HOST_CHECK ENABLE_HOST_CHECK [](#__codelineno-12-56) NAGIOS_EC_PROCESS_SERVICE_CHECK_RESULT PROCESS_SERVICE_CHECK_RESULT [](#__codelineno-12-57) NAGIOS_EC_PROCESS_HOST_CHECK_RESULT PROCESS_HOST_CHECK_RESULT [](#__codelineno-12-58) NAGIOS_EC_SCHEDULE_SERVICE_DOWNTIME SCHEDULE_SERVICE_DOWNTIME [](#__codelineno-12-59) NAGIOS_EC_SCHEDULE_HOST_DOWNTIME SCHEDULE_HOST_DOWNTIME [](#__codelineno-12-60) NAGIOS_EC_DISABLE_HOST_SVC_NOTIFICATIONS DISABLE_HOST_SVC_NOTIFICATIONS [](#__codelineno-12-61) NAGIOS_EC_ENABLE_HOST_SVC_NOTIFICATIONS ENABLE_HOST_SVC_NOTIFICATIONS [](#__codelineno-12-62) NAGIOS_EC_DISABLE_HOST_NOTIFICATIONS DISABLE_HOST_NOTIFICATIONS [](#__codelineno-12-63) NAGIOS_EC_ENABLE_HOST_NOTIFICATIONS ENABLE_HOST_NOTIFICATIONS [](#__codelineno-12-64) NAGIOS_EC_DISABLE_SVC_NOTIFICATIONS DISABLE_SVC_NOTIFICATIONS [](#__codelineno-12-65) NAGIOS_EC_ENABLE_SVC_NOTIFICATIONS ENABLE_SVC_NOTIFICATIONS [](#__codelineno-12-66) ############################################### [](#__codelineno-12-67) ######## End external check types [](#__codelineno-12-68) ############################################### [](#__codelineno-12-69) NAGIOS_WARNING Warning:%{SPACE}%{GREEDYDATA:nagios_message} [](#__codelineno-12-70) [](#__codelineno-12-71) NAGIOS_CURRENT_SERVICE_STATE %{NAGIOS_TYPE_CURRENT_SERVICE_STATE:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{DATA:nagios_statetype};%{DATA:nagios_statecode};%{GREEDYDATA:nagios_message} [](#__codelineno-12-72) NAGIOS_CURRENT_HOST_STATE %{NAGIOS_TYPE_CURRENT_HOST_STATE:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_state};%{DATA:nagios_statetype};%{DATA:nagios_statecode};%{GREEDYDATA:nagios_message} [](#__codelineno-12-73) [](#__codelineno-12-74) NAGIOS_SERVICE_NOTIFICATION %{NAGIOS_TYPE_SERVICE_NOTIFICATION:nagios_type}: %{DATA:nagios_notifyname};%{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{DATA:nagios_contact};%{GREEDYDATA:nagios_message} [](#__codelineno-12-75) NAGIOS_HOST_NOTIFICATION %{NAGIOS_TYPE_HOST_NOTIFICATION:nagios_type}: %{DATA:nagios_notifyname};%{DATA:nagios_hostname};%{DATA:nagios_state};%{DATA:nagios_contact};%{GREEDYDATA:nagios_message} [](#__codelineno-12-76) [](#__codelineno-12-77) NAGIOS_SERVICE_ALERT %{NAGIOS_TYPE_SERVICE_ALERT:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{DATA:nagios_statelevel};%{NUMBER:nagios_attempt};%{GREEDYDATA:nagios_message} [](#__codelineno-12-78) NAGIOS_HOST_ALERT %{NAGIOS_TYPE_HOST_ALERT:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_state};%{DATA:nagios_statelevel};%{NUMBER:nagios_attempt};%{GREEDYDATA:nagios_message} [](#__codelineno-12-79) [](#__codelineno-12-80) NAGIOS_SERVICE_FLAPPING_ALERT %{NAGIOS_TYPE_SERVICE_FLAPPING_ALERT:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{GREEDYDATA:nagios_message} [](#__codelineno-12-81) NAGIOS_HOST_FLAPPING_ALERT %{NAGIOS_TYPE_HOST_FLAPPING_ALERT:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_state};%{GREEDYDATA:nagios_message} [](#__codelineno-12-82) [](#__codelineno-12-83) NAGIOS_SERVICE_DOWNTIME_ALERT %{NAGIOS_TYPE_SERVICE_DOWNTIME_ALERT:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{GREEDYDATA:nagios_comment} [](#__codelineno-12-84) NAGIOS_HOST_DOWNTIME_ALERT %{NAGIOS_TYPE_HOST_DOWNTIME_ALERT:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_state};%{GREEDYDATA:nagios_comment} [](#__codelineno-12-85) [](#__codelineno-12-86) NAGIOS_PASSIVE_SERVICE_CHECK %{NAGIOS_TYPE_PASSIVE_SERVICE_CHECK:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{GREEDYDATA:nagios_comment} [](#__codelineno-12-87) NAGIOS_PASSIVE_HOST_CHECK %{NAGIOS_TYPE_PASSIVE_HOST_CHECK:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_state};%{GREEDYDATA:nagios_comment} [](#__codelineno-12-88) [](#__codelineno-12-89) NAGIOS_SERVICE_EVENT_HANDLER %{NAGIOS_TYPE_SERVICE_EVENT_HANDLER:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{DATA:nagios_statelevel};%{DATA:nagios_event_handler_name} [](#__codelineno-12-90) NAGIOS_HOST_EVENT_HANDLER %{NAGIOS_TYPE_HOST_EVENT_HANDLER:nagios_type}: %{DATA:nagios_hostname};%{DATA:nagios_state};%{DATA:nagios_statelevel};%{DATA:nagios_event_handler_name} [](#__codelineno-12-91) [](#__codelineno-12-92) NAGIOS_TIMEPERIOD_TRANSITION %{NAGIOS_TYPE_TIMEPERIOD_TRANSITION:nagios_type}: %{DATA:nagios_service};%{DATA:nagios_unknown1};%{DATA:nagios_unknown2} [](#__codelineno-12-93) [](#__codelineno-12-94) #################### [](#__codelineno-12-95) #### External checks [](#__codelineno-12-96) #################### [](#__codelineno-12-97) [](#__codelineno-12-98) #Disable host & service check [](#__codelineno-12-99) NAGIOS_EC_LINE_DISABLE_SVC_CHECK %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_DISABLE_SVC_CHECK:nagios_command};%{DATA:nagios_hostname};%{DATA:nagios_service} [](#__codelineno-12-100) NAGIOS_EC_LINE_DISABLE_HOST_CHECK %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_DISABLE_HOST_CHECK:nagios_command};%{DATA:nagios_hostname} [](#__codelineno-12-101) [](#__codelineno-12-102) #Enable host & service check [](#__codelineno-12-103) NAGIOS_EC_LINE_ENABLE_SVC_CHECK %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_ENABLE_SVC_CHECK:nagios_command};%{DATA:nagios_hostname};%{DATA:nagios_service} [](#__codelineno-12-104) NAGIOS_EC_LINE_ENABLE_HOST_CHECK %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_ENABLE_HOST_CHECK:nagios_command};%{DATA:nagios_hostname} [](#__codelineno-12-105) [](#__codelineno-12-106) #Process host & service check [](#__codelineno-12-107) NAGIOS_EC_LINE_PROCESS_SERVICE_CHECK_RESULT %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_PROCESS_SERVICE_CHECK_RESULT:nagios_command};%{DATA:nagios_hostname};%{DATA:nagios_service};%{DATA:nagios_state};%{GREEDYDATA:nagios_check_result} [](#__codelineno-12-108) NAGIOS_EC_LINE_PROCESS_HOST_CHECK_RESULT %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_PROCESS_HOST_CHECK_RESULT:nagios_command};%{DATA:nagios_hostname};%{DATA:nagios_state};%{GREEDYDATA:nagios_check_result} [](#__codelineno-12-109) [](#__codelineno-12-110) #Disable host & service notifications [](#__codelineno-12-111) NAGIOS_EC_LINE_DISABLE_HOST_SVC_NOTIFICATIONS %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_DISABLE_HOST_SVC_NOTIFICATIONS:nagios_command};%{GREEDYDATA:nagios_hostname} [](#__codelineno-12-112) NAGIOS_EC_LINE_DISABLE_HOST_NOTIFICATIONS %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_DISABLE_HOST_NOTIFICATIONS:nagios_command};%{GREEDYDATA:nagios_hostname} [](#__codelineno-12-113) NAGIOS_EC_LINE_DISABLE_SVC_NOTIFICATIONS %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_DISABLE_SVC_NOTIFICATIONS:nagios_command};%{DATA:nagios_hostname};%{GREEDYDATA:nagios_service} [](#__codelineno-12-114) [](#__codelineno-12-115) #Enable host & service notifications [](#__codelineno-12-116) NAGIOS_EC_LINE_ENABLE_HOST_SVC_NOTIFICATIONS %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_ENABLE_HOST_SVC_NOTIFICATIONS:nagios_command};%{GREEDYDATA:nagios_hostname} [](#__codelineno-12-117) NAGIOS_EC_LINE_ENABLE_HOST_NOTIFICATIONS %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_ENABLE_HOST_NOTIFICATIONS:nagios_command};%{GREEDYDATA:nagios_hostname} [](#__codelineno-12-118) NAGIOS_EC_LINE_ENABLE_SVC_NOTIFICATIONS %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_ENABLE_SVC_NOTIFICATIONS:nagios_command};%{DATA:nagios_hostname};%{GREEDYDATA:nagios_service} [](#__codelineno-12-119) [](#__codelineno-12-120) #Schedule host & service downtime [](#__codelineno-12-121) NAGIOS_EC_LINE_SCHEDULE_HOST_DOWNTIME %{NAGIOS_TYPE_EXTERNAL_COMMAND:nagios_type}: %{NAGIOS_EC_SCHEDULE_HOST_DOWNTIME:nagios_command};%{DATA:nagios_hostname};%{NUMBER:nagios_start_time};%{NUMBER:nagios_end_time};%{NUMBER:nagios_fixed};%{NUMBER:nagios_trigger_id};%{NUMBER:nagios_duration};%{DATA:author};%{DATA:comment} [](#__codelineno-12-122) [](#__codelineno-12-123) #End matching line [](#__codelineno-12-124) NAGIOSLOGLINE %{NAGIOSTIME} (?:%{NAGIOS_WARNING}|%{NAGIOS_CURRENT_SERVICE_STATE}|%{NAGIOS_CURRENT_HOST_STATE}|%{NAGIOS_SERVICE_NOTIFICATION}|%{NAGIOS_HOST_NOTIFICATION}|%{NAGIOS_SERVICE_ALERT}|%{NAGIOS_HOST_ALERT}|%{NAGIOS_SERVICE_FLAPPING_ALERT}|%{NAGIOS_HOST_FLAPPING_ALERT}|%{NAGIOS_SERVICE_DOWNTIME_ALERT}|%{NAGIOS_HOST_DOWNTIME_ALERT}|%{NAGIOS_PASSIVE_SERVICE_CHECK}|%{NAGIOS_PASSIVE_HOST_CHECK}|%{NAGIOS_SERVICE_EVENT_HANDLER}|%{NAGIOS_HOST_EVENT_HANDLER}|%{NAGIOS_TIMEPERIOD_TRANSITION}|%{NAGIOS_EC_LINE_DISABLE_SVC_CHECK}|%{NAGIOS_EC_LINE_ENABLE_SVC_CHECK}|%{NAGIOS_EC_LINE_DISABLE_HOST_CHECK}|%{NAGIOS_EC_LINE_ENABLE_HOST_CHECK}|%{NAGIOS_EC_LINE_PROCESS_HOST_CHECK_RESULT}|%{NAGIOS_EC_LINE_PROCESS_SERVICE_CHECK_RESULT}|%{NAGIOS_EC_LINE_SCHEDULE_HOST_DOWNTIME}|%{NAGIOS_EC_LINE_DISABLE_HOST_SVC_NOTIFICATIONS}|%{NAGIOS_EC_LINE_ENABLE_HOST_SVC_NOTIFICATIONS}|%{NAGIOS_EC_LINE_DISABLE_HOST_NOTIFICATIONS}|%{NAGIOS_EC_LINE_ENABLE_HOST_NOTIFICATIONS}|%{NAGIOS_EC_LINE_DISABLE_SVC_NOTIFICATIONS}|%{NAGIOS_EC_LINE_ENABLE_SVC_NOTIFICATIONS})`

  

Grok Patterns: Exim

`[](#__codelineno-13-1) EXIM_MSGID [0-9A-Za-z]{6}-[0-9A-Za-z]{6}-[0-9A-Za-z]{2} [](#__codelineno-13-2) EXIM_FLAGS (<=|[-=>*]>|[*]{2}|==) [](#__codelineno-13-3) EXIM_DATE %{YEAR:exim_year}-%{MONTHNUM:exim_month}-%{MONTHDAY:exim_day} %{TIME:exim_time} [](#__codelineno-13-4) EXIM_PID \[%{POSINT}\] [](#__codelineno-13-5) EXIM_QT ((\d+y)?(\d+w)?(\d+d)?(\d+h)?(\d+m)?(\d+s)?) [](#__codelineno-13-6) EXIM_EXCLUDE_TERMS (Message is frozen|(Start|End) queue run| Warning: | retry time not reached | no (IP address|host name) found for (IP address|host) | unexpected disconnection while reading SMTP command | no immediate delivery: |another process is handling this message) [](#__codelineno-13-7) EXIM_REMOTE_HOST (H=(%{NOTSPACE:remote_hostname} )?(\(%{NOTSPACE:remote_heloname}\) )?\[%{IP:remote_host}\]) [](#__codelineno-13-8) EXIM_INTERFACE (I=\[%{IP:exim_interface}\](:%{NUMBER:exim_interface_port})) [](#__codelineno-13-9) EXIM_PROTOCOL (P=%{NOTSPACE:protocol}) [](#__codelineno-13-10) EXIM_MSG_SIZE (S=%{NUMBER:exim_msg_size}) [](#__codelineno-13-11) EXIM_HEADER_ID (id=%{NOTSPACE:exim_header_id}) [](#__codelineno-13-12) EXIM_SUBJECT (T=%{QS:exim_subject})`

  

Grok Patterns: Bacula

`[](#__codelineno-14-1) BACULA_TIMESTAMP %{MONTHDAY}-%{MONTH} %{HOUR}:%{MINUTE} [](#__codelineno-14-2) BACULA_HOST [a-zA-Z0-9-]+ [](#__codelineno-14-3) BACULA_VOLUME %{USER} [](#__codelineno-14-4) BACULA_DEVICE %{USER} [](#__codelineno-14-5) BACULA_DEVICEPATH %{UNIXPATH} [](#__codelineno-14-6) BACULA_CAPACITY %{INT}{1,3}(,%{INT}{3})* [](#__codelineno-14-7) BACULA_VERSION %{USER} [](#__codelineno-14-8) BACULA_JOB %{USER} [](#__codelineno-14-9) [](#__codelineno-14-10) BACULA_LOG_MAX_CAPACITY User defined maximum volume capacity %{BACULA_CAPACITY} exceeded on device \"%{BACULA_DEVICE:device}\" \(%{BACULA_DEVICEPATH}\) [](#__codelineno-14-11) BACULA_LOG_END_VOLUME End of medium on Volume \"%{BACULA_VOLUME:volume}\" Bytes=%{BACULA_CAPACITY} Blocks=%{BACULA_CAPACITY} at %{MONTHDAY}-%{MONTH}-%{YEAR} %{HOUR}:%{MINUTE}. [](#__codelineno-14-12) BACULA_LOG_NEW_VOLUME Created new Volume \"%{BACULA_VOLUME:volume}\" in catalog. [](#__codelineno-14-13) BACULA_LOG_NEW_LABEL Labeled new Volume \"%{BACULA_VOLUME:volume}\" on device \"%{BACULA_DEVICE:device}\" \(%{BACULA_DEVICEPATH}\). [](#__codelineno-14-14) BACULA_LOG_WROTE_LABEL Wrote label to prelabeled Volume \"%{BACULA_VOLUME:volume}\" on device \"%{BACULA_DEVICE}\" \(%{BACULA_DEVICEPATH}\) [](#__codelineno-14-15) BACULA_LOG_NEW_MOUNT New volume \"%{BACULA_VOLUME:volume}\" mounted on device \"%{BACULA_DEVICE:device}\" \(%{BACULA_DEVICEPATH}\) at %{MONTHDAY}-%{MONTH}-%{YEAR} %{HOUR}:%{MINUTE}. [](#__codelineno-14-16) BACULA_LOG_NOOPEN \s+Cannot open %{DATA}: ERR=%{GREEDYDATA:berror} [](#__codelineno-14-17) BACULA_LOG_NOOPENDIR \s+Could not open directory %{DATA}: ERR=%{GREEDYDATA:berror} [](#__codelineno-14-18) BACULA_LOG_NOSTAT \s+Could not stat %{DATA}: ERR=%{GREEDYDATA:berror} [](#__codelineno-14-19) BACULA_LOG_NOJOBS There are no more Jobs associated with Volume \"%{BACULA_VOLUME:volume}\". Marking it purged. [](#__codelineno-14-20) BACULA_LOG_ALL_RECORDS_PRUNED All records pruned from Volume \"%{BACULA_VOLUME:volume}\"; marking it \"Purged\" [](#__codelineno-14-21) BACULA_LOG_BEGIN_PRUNE_JOBS Begin pruning Jobs older than %{INT} month %{INT} days . [](#__codelineno-14-22) BACULA_LOG_BEGIN_PRUNE_FILES Begin pruning Files. [](#__codelineno-14-23) BACULA_LOG_PRUNED_JOBS Pruned %{INT} Jobs* for client %{BACULA_HOST:client} from catalog. [](#__codelineno-14-24) BACULA_LOG_PRUNED_FILES Pruned Files from %{INT} Jobs* for client %{BACULA_HOST:client} from catalog. [](#__codelineno-14-25) BACULA_LOG_ENDPRUNE End auto prune. [](#__codelineno-14-26) BACULA_LOG_STARTJOB Start Backup JobId %{INT}, Job=%{BACULA_JOB:job} [](#__codelineno-14-27) BACULA_LOG_STARTRESTORE Start Restore Job %{BACULA_JOB:job} [](#__codelineno-14-28) BACULA_LOG_USEDEVICE Using Device \"%{BACULA_DEVICE:device}\" [](#__codelineno-14-29) BACULA_LOG_DIFF_FS \s+%{UNIXPATH} is a different filesystem. Will not descend from %{UNIXPATH} into it. [](#__codelineno-14-30) BACULA_LOG_JOBEND Job write elapsed time = %{DATA:elapsed}, Transfer rate = %{NUMBER} (K|M|G)? Bytes/second [](#__codelineno-14-31) BACULA_LOG_NOPRUNE_JOBS No Jobs found to prune. [](#__codelineno-14-32) BACULA_LOG_NOPRUNE_FILES No Files found to prune. [](#__codelineno-14-33) BACULA_LOG_VOLUME_PREVWRITTEN Volume \"%{BACULA_VOLUME:volume}\" previously written, moving to end of data. [](#__codelineno-14-34) BACULA_LOG_READYAPPEND Ready to append to end of Volume \"%{BACULA_VOLUME:volume}\" size=%{INT} [](#__codelineno-14-35) BACULA_LOG_CANCELLING Cancelling duplicate JobId=%{INT}. [](#__codelineno-14-36) BACULA_LOG_MARKCANCEL JobId %{INT}, Job %{BACULA_JOB:job} marked to be canceled. [](#__codelineno-14-37) BACULA_LOG_CLIENT_RBJ shell command: run ClientRunBeforeJob \"%{GREEDYDATA:runjob}\" [](#__codelineno-14-38) BACULA_LOG_VSS (Generate )?VSS (Writer)? [](#__codelineno-14-39) BACULA_LOG_MAXSTART Fatal error: Job canceled because max start delay time exceeded. [](#__codelineno-14-40) BACULA_LOG_DUPLICATE Fatal error: JobId %{INT:duplicate} already running. Duplicate job not allowed. [](#__codelineno-14-41) BACULA_LOG_NOJOBSTAT Fatal error: No Job status returned from FD. [](#__codelineno-14-42) BACULA_LOG_FATAL_CONN Fatal error: bsock.c:133 Unable to connect to (Client: %{BACULA_HOST:client}|Storage daemon) on %{HOSTNAME}:%{POSINT}. ERR=(?<berror>%{GREEDYDATA}) [](#__codelineno-14-43) BACULA_LOG_NO_CONNECT Warning: bsock.c:127 Could not connect to (Client: %{BACULA_HOST:client}|Storage daemon) on %{HOSTNAME}:%{POSINT}. ERR=(?<berror>%{GREEDYDATA}) [](#__codelineno-14-44) BACULA_LOG_NO_AUTH Fatal error: Unable to authenticate with File daemon at %{HOSTNAME}. Possible causes: [](#__codelineno-14-45) BACULA_LOG_NOSUIT No prior or suitable Full backup found in catalog. Doing FULL backup. [](#__codelineno-14-46) BACULA_LOG_NOPRIOR No prior Full backup Job record found. [](#__codelineno-14-47) [](#__codelineno-14-48) BACULA_LOG_JOB (Error: )?Bacula %{BACULA_HOST} %{BACULA_VERSION} \(%{BACULA_VERSION}\): [](#__codelineno-14-49) [](#__codelineno-14-50) BACULA_LOGLINE %{BACULA_TIMESTAMP:bts} %{BACULA_HOST:hostname} JobId %{INT:jobid}: (%{BACULA_LOG_MAX_CAPACITY}|%{BACULA_LOG_END_VOLUME}|%{BACULA_LOG_NEW_VOLUME}|%{BACULA_LOG_NEW_LABEL}|%{BACULA_LOG_WROTE_LABEL}|%{BACULA_LOG_NEW_MOUNT}|%{BACULA_LOG_NOOPEN}|%{BACULA_LOG_NOOPENDIR}|%{BACULA_LOG_NOSTAT}|%{BACULA_LOG_NOJOBS}|%{BACULA_LOG_ALL_RECORDS_PRUNED}|%{BACULA_LOG_BEGIN_PRUNE_JOBS}|%{BACULA_LOG_BEGIN_PRUNE_FILES}|%{BACULA_LOG_PRUNED_JOBS}|%{BACULA_LOG_PRUNED_FILES}|%{BACULA_LOG_ENDPRUNE}|%{BACULA_LOG_STARTJOB}|%{BACULA_LOG_STARTRESTORE}|%{BACULA_LOG_USEDEVICE}|%{BACULA_LOG_DIFF_FS}|%{BACULA_LOG_JOBEND}|%{BACULA_LOG_NOPRUNE_JOBS}|%{BACULA_LOG_NOPRUNE_FILES}|%{BACULA_LOG_VOLUME_PREVWRITTEN}|%{BACULA_LOG_READYAPPEND}|%{BACULA_LOG_CANCELLING}|%{BACULA_LOG_MARKCANCEL}|%{BACULA_LOG_CLIENT_RBJ}|%{BACULA_LOG_VSS}|%{BACULA_LOG_MAXSTART}|%{BACULA_LOG_DUPLICATE}|%{BACULA_LOG_NOJOBSTAT}|%{BACULA_LOG_FATAL_CONN}|%{BACULA_LOG_NO_CONNECT}|%{BACULA_LOG_NO_AUTH}|%{BACULA_LOG_NOSUIT}|%{BACULA_LOG_JOB}|%{BACULA_LOG_NOPRIOR})`

  

Grok Patterns: Bro

`[](#__codelineno-15-1) # https://www.bro.org/sphinx/script-reference/log-files.html [](#__codelineno-15-2) [](#__codelineno-15-3) # http.log [](#__codelineno-15-4) BRO_HTTP %{NUMBER:ts}\t%{NOTSPACE:uid}\t%{IP:orig_h}\t%{INT:orig_p}\t%{IP:resp_h}\t%{INT:resp_p}\t%{INT:trans_depth}\t%{GREEDYDATA:method}\t%{GREEDYDATA:domain}\t%{GREEDYDATA:uri}\t%{GREEDYDATA:referrer}\t%{GREEDYDATA:user_agent}\t%{NUMBER:request_body_len}\t%{NUMBER:response_body_len}\t%{GREEDYDATA:status_code}\t%{GREEDYDATA:status_msg}\t%{GREEDYDATA:info_code}\t%{GREEDYDATA:info_msg}\t%{GREEDYDATA:filename}\t%{GREEDYDATA:bro_tags}\t%{GREEDYDATA:username}\t%{GREEDYDATA:password}\t%{GREEDYDATA:proxied}\t%{GREEDYDATA:orig_fuids}\t%{GREEDYDATA:orig_mime_types}\t%{GREEDYDATA:resp_fuids}\t%{GREEDYDATA:resp_mime_types} [](#__codelineno-15-5) [](#__codelineno-15-6) # dns.log [](#__codelineno-15-7) BRO_DNS %{NUMBER:ts}\t%{NOTSPACE:uid}\t%{IP:orig_h}\t%{INT:orig_p}\t%{IP:resp_h}\t%{INT:resp_p}\t%{WORD:proto}\t%{INT:trans_id}\t%{GREEDYDATA:query}\t%{GREEDYDATA:qclass}\t%{GREEDYDATA:qclass_name}\t%{GREEDYDATA:qtype}\t%{GREEDYDATA:qtype_name}\t%{GREEDYDATA:rcode}\t%{GREEDYDATA:rcode_name}\t%{GREEDYDATA:AA}\t%{GREEDYDATA:TC}\t%{GREEDYDATA:RD}\t%{GREEDYDATA:RA}\t%{GREEDYDATA:Z}\t%{GREEDYDATA:answers}\t%{GREEDYDATA:TTLs}\t%{GREEDYDATA:rejected} [](#__codelineno-15-8) [](#__codelineno-15-9) # conn.log [](#__codelineno-15-10) BRO_CONN %{NUMBER:ts}\t%{NOTSPACE:uid}\t%{IP:orig_h}\t%{INT:orig_p}\t%{IP:resp_h}\t%{INT:resp_p}\t%{WORD:proto}\t%{GREEDYDATA:service}\t%{NUMBER:duration}\t%{NUMBER:orig_bytes}\t%{NUMBER:resp_bytes}\t%{GREEDYDATA:conn_state}\t%{GREEDYDATA:local_orig}\t%{GREEDYDATA:missed_bytes}\t%{GREEDYDATA:history}\t%{GREEDYDATA:orig_pkts}\t%{GREEDYDATA:orig_ip_bytes}\t%{GREEDYDATA:resp_pkts}\t%{GREEDYDATA:resp_ip_bytes}\t%{GREEDYDATA:tunnel_parents} [](#__codelineno-15-11) [](#__codelineno-15-12) # files.log [](#__codelineno-15-13) BRO_FILES %{NUMBER:ts}\t%{NOTSPACE:fuid}\t%{IP:tx_hosts}\t%{IP:rx_hosts}\t%{NOTSPACE:conn_uids}\t%{GREEDYDATA:source}\t%{GREEDYDATA:depth}\t%{GREEDYDATA:analyzers}\t%{GREEDYDATA:mime_type}\t%{GREEDYDATA:filename}\t%{GREEDYDATA:duration}\t%{GREEDYDATA:local_orig}\t%{GREEDYDATA:is_orig}\t%{GREEDYDATA:seen_bytes}\t%{GREEDYDATA:total_bytes}\t%{GREEDYDATA:missing_bytes}\t%{GREEDYDATA:overflow_bytes}\t%{GREEDYDATA:timedout}\t%{GREEDYDATA:parent_fuid}\t%{GREEDYDATA:md5}\t%{GREEDYDATA:sha1}\t%{GREEDYDATA:sha256}\t%{GREEDYDATA:extracted}`

  

Grok Patterns: Postgresql

`[](#__codelineno-16-1) # Default postgresql pg_log format pattern [](#__codelineno-16-2) POSTGRESQL %{DATESTAMP:timestamp} %{TZ} %{DATA:user_id} %{GREEDYDATA:connection_id} %{POSINT:pid}`

  

Was this page helpful?

Thanks for your feedback!

Thanks for your feedback!